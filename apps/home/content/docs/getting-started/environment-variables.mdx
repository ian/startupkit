---
title: Environment Variables
description: Managing environment variables in StartupKit
icon: KeyRound
---

This guide covers how environment variables work in StartupKit and the helpers available for managing them.

## Quick Setup

After running `npx startupkit init`, create your environment file:

```bash
cp .env.example .env.local
```

The `.env.example` file contains all available variables with documentation.

## Environment Files

| File | Purpose | Committed to Git |
|------|---------|------------------|
| `.env.local` | Local development values | No |
| `.env.test` | Test environment values | No |
| `.env.production` | Production overrides | No |

## Core Variables

These variables are used across the application:

| Variable | Required | Description |
|----------|----------|-------------|
| `DATABASE_URL` | Yes | PostgreSQL connection string |
| `BETTER_AUTH_SECRET` | Yes | Secret key for signing auth tokens |

```bash title=".env.local"
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/myapp
BETTER_AUTH_SECRET=your-secret-key-here
```

Generate a secure auth secret:

```bash
openssl rand -base64 32
```

## Running with Environment Variables

StartupKit includes helpers for running commands with environment variables loaded:

### pnpm with-env

Runs a command with `.env.local` loaded:

```bash
pnpm with-env <command>
```

Examples:

```bash
# Run database migrations with env vars
pnpm with-env pnpm db:migrate

# Run a script with env vars
pnpm with-env node scripts/seed.js

# Start the dev server (already uses with-env internally)
pnpm dev
```

### pnpm with-test-env

Runs a command with `.env.test` loaded:

```bash
pnpm with-test-env <command>
```

Examples:

```bash
# Run tests with test environment
pnpm with-test-env pnpm test

# Run a specific test file
pnpm with-test-env vitest run src/lib/auth.test.ts
```

This is useful for:
- Using a separate test database
- Mocking external services
- Isolated test configurations

## Next.js Environment Rules

Next.js has specific rules for environment variables:

| Prefix | Availability | Use For |
|--------|--------------|---------|
| `NEXT_PUBLIC_` | Client + Server | Public values (analytics keys) |
| No prefix | Server only | Secrets, credentials |

```bash
# Exposed to browser - safe for public API keys
NEXT_PUBLIC_POSTHOG_KEY=phc_xxx

# Server only - never exposed to client
DATABASE_URL=postgresql://...
BETTER_AUTH_SECRET=xxx
```

## Package-Specific Variables

Each package has its own environment variables documented in its respective section:

- **[Authentication](/docs/auth/configuration)** — OAuth providers, auth settings
- **[Analytics](/docs/analytics)** — PostHog, Google Analytics, OpenPanel
- **[Database](/docs/db)** — Connection strings, pooling
- **[Emails](/docs/emails)** — Resend API keys

## Deployment

See the [Deployment guide](/docs/deployment) for platform-specific instructions on setting environment variables in production.

## Security Best Practices

1. **Never commit `.env.local`** — It's in `.gitignore` by default
2. **Use different secrets per environment** — Dev, staging, production
3. **Rotate secrets regularly** — Especially after team changes
4. **Limit access** — Only give team members access to secrets they need

## Troubleshooting

### Variable Not Available

1. Check the name matches exactly (case-sensitive)
2. Restart the dev server after changes
3. For client-side, ensure `NEXT_PUBLIC_` prefix
4. In Vercel, check the correct environment is selected

### "Process is not defined"

This happens when accessing server-only variables on the client. Keep server-only variables in server-only files:

```typescript
// lib/db.ts (server-only, never imported by client)
const dbUrl = process.env.DATABASE_URL
```
